#!/bin/bash
set -euo pipefail

PATTERN="$BUILDKITE_PLUGIN_INFRACOST_PATTERN"

PLAN="$BUILDKITE_PLUGIN_INFRACOST_PLAN"

INFRACOST_VERSION="$BUILDKITE_PLUGIN_INFRACOST_VERSION"

echo "--- :1234: Counting the number of files"

echo "--- Analysing Costs for the :terraform: plan ${PLAN} with ${INFRACOST_VERSION}"

# so here we want to

COUNT=$(find . -name "$PATTERN" | wc -l)

echo "Found ${COUNT} files matching ${PATTERN}"

buildkite-agent annotate "Found ${COUNT} files matching ${PATTERN}"
